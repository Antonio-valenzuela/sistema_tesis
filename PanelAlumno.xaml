<Window x:Class="SistemaSeguimientoTesis.Views.PanelAlumno" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Title="Panel de Alumno" Height="560" Width="980" WindowStartupLocation="CenterScreen">
	<Grid Margin="10">
		<TabControl x:Name="TabControlAlumno">
			<!-- ========================= Pestaña 0: Mi Proyecto ========================= -->
			<TabItem Header="Mi Proyecto">
				<Grid Margin="10">
					<!-- Panel cuando NO tiene proyecto -->
					<StackPanel Visibility="{Binding PanelSinProyectoVisibility}"
								HorizontalAlignment="Center"
								VerticalAlignment="Center">
						<Image Source="/Resources/checklist.png"
							   Width="200"
							   Margin="0,0,0,10"/>
						<TextBlock Text="Aún no tienes un proyecto registrado."
								   FontSize="16"
								   FontWeight="Bold"
								   TextAlignment="Center"
								   Margin="0,0,0,5"/>
						<TextBlock Text="Habla con tu profesor o espera a que te asignen uno."
								   TextAlignment="Center"/>
					</StackPanel>

					<!-- Panel cuando SÍ tiene proyecto -->
					<StackPanel Visibility="{Binding PanelConProyectoVisibility}"
								HorizontalAlignment="Center"
								VerticalAlignment="Center">
						<Image Source="/Resources/cohete.png"
							   Width="200"
							   Margin="0,0,0,10"/>
						<TextBlock Text="Ya tienes un proyecto registrado."
								   FontSize="16"
								   FontWeight="Bold"
								   TextAlignment="Center"
								   Margin="0,0,0,10"/>
						<Button Content="Ver seguimiento"
								Width="150"
								Height="35"
								Click="BtnIrASeguimiento_Click"/>
					</StackPanel>
				</Grid>
			</TabItem>

			<!-- ========================= Pestaña 1: Seguimiento - Vista previa - Comentarios/feedback ========================= -->
			<TabItem Header="Seguimiento">
				<Grid Margin="10">
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="*"/>
					</Grid.RowDefinitions>
					<!-- Barra superior: progreso + acciones -->
					<DockPanel Grid.Row="0" LastChildFill="False" Margin="0,0,0,10">
						<StackPanel Orientation="Horizontal" DockPanel.Dock="Left">
							<TextBlock Text="Progreso del proyecto:" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,10,0"/>
							<ProgressBar x:Name="barraProgreso" Width="300" Height="20" Minimum="0" Maximum="100"/>
						</StackPanel>
						<StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
							<Button Content="Subir entrega" Margin="0,0,10,0" Width="120" Height="30" Click="BtnSubirEntrega_Click"/>
							<Button Content="Vista previa" Width="110" Height="30" Click="BtnVistaPreviaEntrega_Click" ToolTip="Abre la entrega seleccionada para previsualizarla"/>
							<Button Content="Descargar" Margin="10,0,0,0" Width="110" Height="30" Click="BtnDescargarEntrega_Click" ToolTip="Guarda la entrega seleccionada en tu equipo"/>
						</StackPanel>
					</DockPanel>
					<!-- Cuerpo con 2 columnas: Izq: Entregas Der: Comentarios -->
					<Grid Grid.Row="1">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="2.1*"/>
							<ColumnDefinition Width="1.4*"/>
						</Grid.ColumnDefinitions>
						<!-- Entregas -->
						<GroupBox Grid.Column="0" Header="Entregas realizadas" Margin="0,0,10,0">
							<Grid>
								<Grid.RowDefinitions>
									<RowDefinition Height="*"/>
									<RowDefinition Height="Auto"/>
								</Grid.RowDefinitions>
								<ListView x:Name="listaEntregas" Grid.Row="0" SelectionChanged="ListaEntregas_SelectionChanged" MouseDoubleClick="ListaEntregas_DoubleClick">
									<ListView.View>
										<GridView>
											<GridViewColumn Header="Título" DisplayMemberBinding="{Binding Titulo}" Width="260"/>
											<GridViewColumn Header="Tipo" DisplayMemberBinding="{Binding Tipo}" Width="120"/>
											<GridViewColumn Header="Fecha" DisplayMemberBinding="{Binding FechaEntrega}" Width="140"/>
											<!-- EntregaID oculto -->
											<GridViewColumn Header="Id" DisplayMemberBinding="{Binding EntregaID}" Width="0"/>
										</GridView>
									</ListView.View>
								</ListView>
								<TextBlock Grid.Row="1" Margin="6" Foreground="Gray" Text="Tip: doble click en una entrega para abrir vista previa." />
							</Grid>
						</GroupBox>
						<!-- Comentarios / feedback -->
						<GroupBox Grid.Column="1" Header="Comentarios del profesor" Margin="0">
							<Grid>
								<Grid.RowDefinitions>
									<RowDefinition Height="*"/>
									<RowDefinition Height="Auto"/>
									<RowDefinition Height="Auto"/>
								</Grid.RowDefinitions>
								<!-- Lista de comentarios -->
								<ListBox x:Name="lbComentarios" Grid.Row="0" Margin="0,0,0,8">
									<ListBox.ItemTemplate>
										<DataTemplate>
											<Border BorderBrush="#DDD" BorderThickness="1" Padding="6" Margin="0,0,0,6" CornerRadius="6">
												<StackPanel>
													<TextBlock Text="{Binding Autor}" FontWeight="Bold"/>
													<TextBlock Text="{Binding FechaTexto}" Foreground="Gray" FontSize="11"/>
													<TextBlock Text="{Binding Texto}" TextWrapping="Wrap" Margin="0,4,0,0"/>
												</StackPanel>
											</Border>
										</DataTemplate>
									</ListBox.ItemTemplate>
								</ListBox>
								<!-- Nuevo comentario -->
								<TextBox x:Name="txtNuevoComentario" Grid.Row="1" AcceptsReturn="True" TextWrapping="Wrap" Height="70" VerticalScrollBarVisibility="Auto" Margin="0,0,0,6" ToolTip="Escribe un comentario para tu profesor (opcional)"/>
								<StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
									<Button Content="Enviar comentario" Width="150" Height="28" Click="BtnEnviarComentario_Click"/>
									<Button Content="Marcar como resuelto" Width="170" Height="28" Margin="8,0,0,0" Click="BtnResolverComentario_Click" ToolTip="Marca el comentario seleccionado como resuelto"/>
								</StackPanel>
							</Grid>
						</GroupBox>
					</Grid>
				</Grid>
			</TabItem>
			<!-- ========================= Pestaña 2: Agenda / Citas ========================= -->
			<TabItem Header="Citas / Agenda">
				<Grid Margin="10">
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="*"/>
						<RowDefinition Height="*"/>
					</Grid.RowDefinitions>
					<!-- Barra superior -->
					<StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,10">
						<TextBlock Text="Agenda con tu asesor" FontWeight="Bold" FontSize="14" VerticalAlignment="Center"/>
						<Button Content="Actualizar" Width="110" Height="28" Margin="15,0,0,0" Click="BtnActualizarAgenda_Click"/>
					</StackPanel>
					<!-- Disponibilidad del profesor -->
					<GroupBox Grid.Row="1" Header="Disponibilidad del profesor" Margin="0,0,0,10">
						<Grid>
							<Grid.RowDefinitions>
								<RowDefinition Height="*"/>
								<RowDefinition Height="Auto"/>
							</Grid.RowDefinitions>
							<DataGrid x:Name="dgDisponibilidad" Grid.Row="0" AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single" AlternatingRowBackground="#F5F5FA" RowBackground="White" VerticalScrollBarVisibility="Auto">
								<DataGrid.Columns>
									<DataGridTextColumn Header="Fecha" Binding="{Binding FechaTexto}" Width="150"/>
									<DataGridTextColumn Header="Hora inicio" Binding="{Binding HoraInicio}" Width="120"/>
									<DataGridTextColumn Header="Hora fin" Binding="{Binding HoraFin}" Width="120"/>
									<DataGridTextColumn Header="Comentario" Binding="{Binding Comentario}" Width="*"/>
								</DataGrid.Columns>
							</DataGrid>
							<StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,6,0,0">
								<Button Content="Agendar cita" Width="130" Height="28" Click="BtnAgendarCita_Click" ToolTip="Agenda la disponibilidad seleccionada"/>
							</StackPanel>
						</Grid>
					</GroupBox>
					<!-- Mis citas -->
					<GroupBox Grid.Row="2" Header="Mis citas">
						<Grid>
							<Grid.RowDefinitions>
								<RowDefinition Height="*"/>
								<RowDefinition Height="Auto"/>
							</Grid.RowDefinitions>
							<DataGrid x:Name="dgMisCitas" Grid.Row="0" AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single" AlternatingRowBackground="#F5F5FA" RowBackground="White" VerticalScrollBarVisibility="Auto">
								<DataGrid.Columns>
									<DataGridTextColumn Header="Fecha" Binding="{Binding FechaTexto}" Width="160"/>
									<DataGridTextColumn Header="Estado" Binding="{Binding Estado}" Width="110"/>
									<DataGridTextColumn Header="Descripción" Binding="{Binding Descripcion}" Width="*"/>
									<DataGridTextColumn Header="Link" Binding="{Binding LinkVirtual}" Width="220"/>
								</DataGrid.Columns>
							</DataGrid>
							<StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,6,0,0">
								<Button Content="Cancelar cita" Width="130" Height="28" Click="BtnCancelarCita_Click"/>
							</StackPanel>
						</Grid>
					</GroupBox>
				</Grid>
			</TabItem>
			<!-- ========================= Pestaña 3: Notificaciones ========================= -->
			<TabItem Header="Notificaciones">
				<Grid Margin="10">
					<GroupBox Header="🔔 Notificaciones" Margin="0" BorderBrush="#4B0082" BorderThickness="1" Padding="8">
						<Grid>
							<Grid.RowDefinitions>
								<RowDefinition Height="Auto"/>
								<RowDefinition Height="*"/>
							</Grid.RowDefinitions>
							<!-- Barra superior -->
							<StackPanel Orientation="Horizontal" Margin="0,0,0,8">
								<TextBlock Text="Notificaciones pendientes: " VerticalAlignment="Center"/>
								<TextBlock x:Name="txtNotificacionesPendientes" FontWeight="Bold" Foreground="Red" VerticalAlignment="Center" Margin="4,0,20,0"/>
								<Button Content="Actualizar" Width="90" Margin="0,0,10,0" Click="BtnActualizarNotificaciones_Click"/>
								<Button Content="Marcar todas como leídas" Width="170" Click="BtnMarcarLeidas_Click"/>
							</StackPanel>
							<!-- Lista -->
							<DataGrid x:Name="dgNotificaciones" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single" AlternatingRowBackground="#F5F5FA" RowBackground="White" VerticalScrollBarVisibility="Auto">
								<DataGrid.Columns>
									<DataGridTextColumn Header="Fecha" Binding="{Binding FechaTexto}" Width="150"/>
									<DataGridTextColumn Header="Título" Binding="{Binding Titulo}" Width="200"/>
									<DataGridTextColumn Header="Mensaje" Binding="{Binding Mensaje}" Width="*"/>
									<DataGridTextColumn Header="Estado" Binding="{Binding Estado}" Width="100"/>
								</DataGrid.Columns>
							</DataGrid>
						</Grid>
					</GroupBox>
				</Grid>
			</TabItem>
		</TabControl>
	</Grid>
</Window>






